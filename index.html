
    <button id="capture-button"></button>
    <div id="overlay">
        <span id="timer"></span>
    </div>
    <video id="video" autoplay playsinline style="display:none;"></video>

    <!-- Firebase Configuration -->
    <script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-storage.js"></script>
    <script>
        // Your Firebase configuration
        var firebaseConfig = {
 	   apiKey: "AIzaSyCIY6aAg-JCpKnm6X51tEktW6v_fLWfU10",
  	   authDomain: "satsuei-c1b33.firebaseapp.com",
 	   projectId: "satsuei-c1b33",
 	   storageBucket: "satsuei-c1b33.appspot.com",
 	   messagingSenderId: "948629477465",
	   appId: "1:948629477465:web:84c23181285afd9d86f948",
 	   measurementId: "G-KS0947K55F"
	};
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        var storage = firebase.storage();
    </script>

    <!-- Camera and Capture Script -->
    <script>
        const captureButton = document.getElementById('capture-button');
        const overlay = document.getElementById('overlay');
        const video = document.getElementById('video');
        const timerElement = document.getElementById('timer');
        let mediaStream = null;
        let captureInterval = null;
        let countdownInterval = null;
        let countdown = 10;

        captureButton.addEventListener('click', async () => {
            captureButton.style.display = 'none';
            overlay.style.display = 'flex';
            startCountdown();

            try {
                mediaStream = await navigator.mediaDevices.getUserMedia({ video: true });
                video.srcObject = mediaStream;

                captureInterval = setInterval(captureAndUpload, 10000);
            } catch (err) {
                console.error('Error accessing camera: ', err);
                captureButton.style.display = 'block';
                overlay.style.display = 'none';
            }
        });

        overlay.addEventListener('click', () => {
            clearInterval(captureInterval);
            clearInterval(countdownInterval);
            overlay.style.display = 'none';
            captureButton.style.display = 'block';
            countdown = 10;

            if (mediaStream) {
                mediaStream.getTracks().forEach(track => track.stop());
                mediaStream = null;
            }
        });

        function startCountdown() {
            timerElement.textContent = countdown;
            countdownInterval = setInterval(() => {
                countdown--;
                if (countdown < 0) {
                    countdown = 10;
                }
                timerElement.textContent = countdown;
            }, 1000);
        }

        async function captureAndUpload() {
            const canvas = document.createElement('canvas');
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            const context = canvas.getContext('2d');
            context.drawImage(video, 0, 0, canvas.width, canvas.height);

            canvas.toBlob(async (blob) => {
                const storageRef = storage.ref();
                const fileRef = storageRef.child(`images/${new Date().toISOString()}.jpg`);
                await fileRef.put(blob);
                console.log('Uploaded a blob or file!');
            }, 'image/jpeg');
        }
    </script>
</body>
</html>
